<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Notifications | WebClient documentation</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="../../assets/css/root.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body style="background: white;" data-spy="scroll" data-target=".bs-sidebar">

    <div class="root">
    
<div class="navbar navbar-inverse" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../index.html">WebClient documentation</a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      
        <ul class="nav navbar-nav">
          <li class="active"><a href="index.html">Docs</a></li>
          <li><a href="../api-client/index.html">API Client</a></li>
        </ul>
      

      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">CROC R&D<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="https://track.rnd.croc.ru">Bug tracker (YouTrack)</a></li>
            <li><a href="https://code.croc.ru">Source code (Git Server)</a></li>
            <li><a href="https://wiki.rnd.croc.ru">Wiki</a></li>
            <li><a href="https://build.rnd.croc.ru">Build server (TeamCity)</a></li>
            <li><a href="https://qa.rnd.croc.ru">Q&A</a></li>
            <li class="divider"></li>
            <li class="dropdown-header">Other</li>
            <li><a href="https://github.com/CrocInc">CROC on Github</a></li>
            
          </ul>
        </li>
      </ul>

    </nav>
  </div>
</div>

    
<div class="container" role="main">
  <div class="row">

    
    <div class="col col-lg-3">
      <div class="sidebar">
        <ul class="nav nav-pills nav-stacked">
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
          <li><a href="structure.html">Structure</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
          <li><a href="browser-support.html">Browser support</a></li>
    
  
    
  
    
  
    
          <li><a href="distribution.html">Distribution</a></li>
    
  
    
  
    
  
    
          <li><a href="setup-developer-environment.html">Setup Developer Environment</a></li>
    
  
    
  
    
  
    
          <li><a href="project-structure.html">Project Structure</a></li>
    
  
    
  
    
  
    
  
    
  
    
          <li><a href="key-features.html">Key Features</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</ul>


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  
    
  

  

  

  
    
  

  

  

  
    
  

  

  
    
      <span class="nav-section-title">
        <a href="getting-started-tutorial.html">Getting Started Tutorial</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="getting-started-tutorial-0_12.html">Getting Started Tutorial 0.12</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
      </ul>

    
  

  

  

  
    
  

  

  
    
      <span class="nav-section-title">
        <a href="base.html">Base</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="ecmascript-5-emulation.html">EcmaScript 5 emulation</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="module-system.html">Module System</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="core.html">Core</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="class-system.html">Class System</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="presentation-model.html">Presentation Model</a></li>
        
        
       
        
         

          <li><a href="composition-&amp;-navigation.html">Composition &amp; Navigation</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="переопределение-компонентов.html">Переопределение компонентов</a></li>
        
        
       
        
         

          <li><a href="templating.html">Templating</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="data-binding.html">Data-binding</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="eventpublisher.html">EventPublisher</a></li>
        
        
       
        
       
        
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="application.html">Application</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
         

          <li><a href="app-module.html">App-module</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="datasource.html">DataSource</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="domain-model.html">Domain Model</a></li>
        
        
       
        
         

          <li><a href="domain-objects.html">Domain Objects</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="validation.html">Validation</a></li>
        
        
       
        
       
        
         

          <li><a href="formatters.html">Formatters</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="interop.html">Interop</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="main_js.html">main.js</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="ui-ux.html">UI-UX</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
         

          <li><a href="app-starting-ux.html">App starting UX</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="appnavbar.html">AppNavBar</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="css-styles-and-less.html">CSS Styles and LESS</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="tree.html">Tree</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="icons.html">Icons</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="menu.html">Menu</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="objecteditor.html">ObjectEditor</a></li>
        
        
       
        
       
        
         

          <li><a href="objectlist.html">ObjectList</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="objectviewer.html">ObjectViewer</a></li>
        
        
       
        
         

          <li><a href="objectwizard.html">ObjectWizard</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="onlinebeacon.html">OnlineBeacon</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="property-editors.html">Property Editors</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="objectfilter.html">ObjectFilter</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="appservices.html">AppServices</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
         

          <li><a href="affix.html">Affix</a></li>
        
        
       
        
         

          <li><a href="app-navigation.html">App Navigation</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="breadcrumbs.html">Breadcrumbs</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="client-update-notification.html">Client update notification</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="debug-module.html">Debug module</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="drafts.html">Drafts</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="i18n.html">i18n</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li class="active"><a href="notifications.html">Notifications</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="security.html">Security</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="scroll-accelerators.html">Scroll accelerators</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="reporting.html">Reporting</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="server.html">Server</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="server-architecture.html">Server Architecture</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="page-layout.html">Page Layout</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="filecontroller.html">FileController</a></li>
        
        
       
        
         

          <li><a href="bootloader.html">Bootloader</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="main_config_json.html">main.config.json</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="hosting.html">Hosting</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="knowledge-base.html">Knowledge Base</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="client-debugging.html">Client Debugging</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="кеширование-контента.html">Кеширование контента</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="webstorm-live-templates.html">WebStorm Live Templates</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="efficient-css.html">Efficient CSS</a></li>
        
        
       
        
         

          <li><a href="elmah.html">Elmah</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="devtools.html">DevTools</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="archived-build-0_10.html">Archived-Build 0.10</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="настройка-teamcity-билд-конфигурации-для-работы-с-bower-и-grunt.html">Настройка TeamCity билд конфигурации для работы с bower и grunt</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="yeoman-generator.html">Yeoman Generator</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="grunt-croc-qunit.html">grunt-croc-qunit</a></li>
        
        
       
        
         

          <li><a href="grunt-croc-requirejs.html">grunt-croc-requirejs</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="resxtojson.html">ResxToJson</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
      </ul>

    
  


      </div>
    </div>


    
    <div class="col col-lg-9">
      <div class="panel panel-docs">
        <ol class='breadcrumb'><li><a href='index.html'>Docs</a></li><li><a href='appservices.html'>AppServices</a></li><li class='active'>Notifications</li></ol>
        <h1>Notifications</h1>
          

<blockquote>
<p>В версии <a href='http://wiki.rnd.croc.ru/display/xfwajax/Release+0.15' title='null'>xfwajax:Release 0.15</a> произошли существенные изменения.</p>
</blockquote>
<p>Модуль notifications подписывается на все события, публикуемые через EventPublisher, экземпляр которого содержит Application. </p>
<p>Также модуль notifications добавляет пункт в системное меню (SystemMenu), открывающий popup-панель с историей уведомлений (EventLog).</p>
<p>Полученное pub/sub событие модуль передает в <code>NotificationManager.publishNotification</code> </p>
<p>NotificationManager обрабатывает объект события только, если он содержит свойство isSystemEvent. Т.е. NotificationManager поддерживает только экземпляры SystemEvent, игнорируя все остальные события, опубликованные через EventPublisher.</p>
<p>NotificationManager различает события SystemEvent следующих видов:</p>
<ul>
<li>process - &quot;процесс&quot; - уведомление-статус выполнения некоторой операции (обычно долгой), исчезает само при завершении операции;</li>
<li>notification - &quot;уведомление&quot; - в зависимости от приоритета исчезает само, либо висит пока пользователь его не закроет, но в любом случае может быть закрыто;</li>
<li>actionRequest - &quot;запрос на действие&quot; - отображается в виде полосы, всегда содержит меню, операция из которого должна быть выполнена пользователем, уведомление не может быть закрыто пока операция не выполнится.</li>
</ul>
<p>Каждый вид событий NotificationManager обрабатывает по-разному. Дополнительно, на способ обработки влияет приоритет события (priority).</p>
<p>При клике на пункт меню &quot;Уведомления&quot; (&quot;Notification&quot;) в SystemMenu открывается popup-окно, содержащее список событий - EventLog. События добавляются в EventLog в зависимости от типа и приоритета (см. ниже подробней описание каждого типа событий).</p>
<h3 id="systemevent-kind-process-">SystemEvent.kind=&quot;process&quot;</h3>
<p>События данного типа отражают некий процесс. Инициатор процесса отвечает за его завершение. Например, события типа process публикует метод DataFacade.load (загрузка данных с сервера). Событие типа процесс должно содержать объект Deferred, разрешение которого сигнализирует о завершении процесса.
Отображение события типа процесс зависит от приоритета:</p>
<table class='table table-striped table-hover'>
<thead><tr>
<th>priority</th>
<th>UI-нотификация</th>
<th>Добавление в историю (EventLog)</th>
</tr>
</thead>
<tbody><tr>
<td>high</td>
<td>Да</td>
<td>Да</td>
</tr>
<tr>
<td>normal</td>
<td>Да</td>
<td>Нет</td>
</tr>
<tr>
<td>low</td>
<td>Нет</td>
<td>Да</td>
</tr>
</tbody>
</table>
<p>UI-нотификация процесса отличается от UI-нотификации для события типа notification. Нотификация процесса отображается в самом верху экрана посередине. Если событий создается несколько (например, несколько параллельных обращений на сервер), то нотификации отображаются поверх друг друга.
При добавлении события в EventLog, оно считается активным и отображается там до тех пор, пока процесс не завершится.
События процессы по умолчанию создаются в методах DataFacade <code>load</code>, <code>save</code> и <code>ajax</code>. Для отключения созданию нотификаций надо задать опцию <code>suppressProcessEvent</code>. Для метода <code>ajax</code> можно также задать опцию <code>processEvent</code>, в которой определить некоторые свойства события (сообщение/приоритет).
Отключать публикацию события имеет смысл, если операция выполняется модально. Например, синхронное (модальное) сохранение в редакторе (т.к. UI приложения блокируется, то необходимости в еще одной нотификации нет).</p>
<h3 id="systemevent-kind-actionrequest-">SystemEvent.kind=&quot;actionRequest&quot;</h3>
<p>Событие представляет собой запрос реакции пользователя. Всегда содержит меню. Если публикуемый объект SystemEvent не содержит меню, то его добавляет NotificationManager (с единственной операцией &quot;Закрыть&quot;).
События типа actionRequest не поддерживают приоритеты и всегда отображаются одинаково.
При публикации очередного события actionRequest, если уже одно активно, оно добавляется в список событий парта отображающего нотификации - <code>NotificationBar</code>. Парт поддерживает карусель для переключения между событиями. При выполнении любой команды меню события, событие деактивируется и NotificationBar удаляет UI для него. Если это было единственное активное событие, парт NotificationBar исчезает, иначе активируется следующее событие.</p>
<p>События типа actionRequest не добавляются в EventLog.</p>
<blockquote>
<p>До версии 0.15 подобные события отображались как обычные нотификации без возможности закрытия (isModal=true)</p>
</blockquote>
<h3 id="systemevent-kind-notification-">SystemEvent.kind=&quot;notification&quot;</h3>
<p>События типа notification - это уведомления. До версии 0.15 это был единственный вариант. Для события всегда создается UI-нотификация в виде всплывающего &quot;balloon&quot;, создаемого с помощью библиотеки jquery.notify. Каждая нотификация может быть закрыта. В этом случае, соответствующий объект SystemEvent меняет состояние на <code>archived</code>. Если же, нотификация закрылась сама (по таймауту), в том числе из-за того, что появилась следующая нотификация, то состояние SystemEvent остается <code>active</code>.
Нотификации событий с приоритетом &quot;high&quot; не закрываются по тайм-ауту.
События с приотетами high и normal добавляются в EventLog (т.е. low не добавляется).</p>
<table class='table table-striped table-hover'>
<thead><tr>
<th>priority</th>
<th>UI-нотификация (notify)</th>
<th>Добавление в историю (EventLog)</th>
</tr>
</thead>
<tbody><tr>
<td>high</td>
<td>Да, постоянная</td>
<td>Да</td>
</tr>
<tr>
<td>normal</td>
<td>Да, исчезающая</td>
<td>Да</td>
</tr>
<tr>
<td>low</td>
<td>Да, исчезающая</td>
<td>Нет</td>
</tr>
</tbody>
</table>
<p>Элемент системного меню модуля нотификаций отображает бейджик с количеством нотификаций в состоянии active.</p>
<h3 id="-">Нотификации и ошибки сохранения</h3>
<p>Сохранение объектов всегда выполняется через UnitOfWork: </p>
<pre><code class="lang-js">uow.save()
</code></pre>
<p>Метод save возвращает Deferred, но он напрямую не зависит от Deferred, возвращаемого методом <code>DataFacade.save</code>, который вызывает UnitOfWork. <code>UnitOfWork.save</code> подписывает собственные обработчики на resolve/reject Deferred, возвращаемого из <code>DataFacade.save</code>. Помимо стандартной реакции (см. ниже), заканчивающейся разрешением возвращенного Deferred, <code>UnitOfWork.save</code> поддерживает задание кастомных обработчиков через опции метода save: onSuccess и onError.
Обработчики (если переданы) будут вызываны со следующими параметрами:</p>
<ul>
<li>onSuccess:<ul>
<li>options - объект опцией, который был передан в DataFacade.save</li>
<li>objects - JSON объект сохраняемых данных, который был передан в DataFacade.save</li>
<li>states - массив имен состояний UnitOfWork (созданных с помощью saveState) на момент вызова save</li>
<li>deferred - объект Deferred, возвращенный из UnitOfWork.save</li>
<li>complete - колбэк, выполняющий стандарную обработку UnitOfWork в случае успеха (т.е. как если бы опция onSuccess не была задана)</li>
<li>resolve - стандарная обработка UnitOfWork в случае успеха (тоже самое, что complete)</li>
<li>reject - стандарная обработка UnitOfWork в случае ошибки</li>
</ul>
</li>
<li>onError<ul>
<li>объект ошибки (полученный из DataFacade)</li>
<li>options - объект опцией, который был передан в DataFacade.save</li>
<li>objects - JSON объект сохраняемых данных, который был передан в DataFacade.save</li>
<li>states - массив имен состояний UnitOfWork (созданных с помощью saveState) на момент вызова save</li>
<li>deferred - объект Deferred, возвращенный из UnitOfWork.save</li>
<li>complete - колбэк, выполняющий стандарную обработку UnitOfWork в случае ошибки (т.е. как если бы опция onError не была задана)</li>
<li>resolve - стандарная обработка UnitOfWork в случае успеха</li>
<li>reject - стандарная обработка UnitOfWork в случае ошибки (тоже самое, что complete)</li>
</ul>
</li>
</ul>
<p>Стандартная обработка в случае успеха:</p>
<ul>
<li>проакциптить все состояния (т.е. вызвать acceptState) из списка states </li>
<li>каждому сохраненному объекту обновим ts и значения свойств из json, который возвращает DataFacade (значения св-в могут измениться в результате сохранения)</li>
<li>удаленным объектам установить состояние invalid и удалить их из UnitOfWork (detach)</li>
<li>возбудить событие &quot;saved&quot;, в качестве параметра передается объект:<ul>
<li>objects - сохраненные объекты</li>
<li>created - созданные объекты</li>
<li>deleted - удаленные объекты</li>
<li>stateName - имя последнего состояния</li>
</ul>
</li>
<li>разрешить (resolve) Deferred, возвращенный из save</li>
</ul>
<p>Стандартная обработка в случае ошибки:</p>
<ul>
<li>проакцептим (acceptState) состояние, созданное перед вызывом DataFacade.save (т.е. смержим изменения до сохранения и изменения, сделанные во время сохранения)</li>
<li>возбуить событие saveError, в качестве параметра передается объект:<ul>
<li>objects - сохраняемые объекты (но не сохраненные из-за ошибки)</li>
<li>error - объект ошибки</li>
</ul>
</li>
<li>разрешить (reject) Deferred, возвращенный из save</li>
</ul>
<p>DataFacade внутри save также имеет обработку результата вызова сервера (через BackendInterop). Она отличается для разных реализация DataFacade (DataFacade и DataFacadeSmart). Но в целом заключается в создании SystemEvent и публикации его через <a href='eventpublisher.html' title='null'>EventPublisher</a>.
В случае успеха публикуется SystemEvent &quot;interop.save.success&quot;: kind=&quot;notification&quot;, priority=&quot;low&quot;, severity=&quot;sucess&quot;.
В случае ошибки публикуется SystemEvent &quot;interop.save.error&quot;: kind=&quot;notification&quot;, priority=&quot;high&quot;, severity=&quot;error&quot;.
DataFacade по умолчанию публикует события error/success, но это может быть отключено с помощью опций suppressEventOnError/suppressEventOnSuccess, переданных в метод save (UnitOfWork и DataFacade).</p>
<p>Важно то, что DataFacade разрешает Deferred операции save в любом случае (в независимости от публикации события). </p>
<blockquote>
<p>Данное поведение появилось начиная с версии 0.15. До версии 0.14 включительно, разрешение Deferred (возвращенного из DataFacade.save) происходили после выполнения любой команды меню нотификации (и только, если нотификация не содержала меню, Deferred разрешался сразу). Это давало возможность добавить в нотификацию ошибки команды, которые выполнялись бы в рамках процесса сохранения (т.е. до возврата результата из UnitOfWork). Например, команда &quot;Сохранить локально&quot; могла сохранить данные, при сохранении которых на сервер возникла ошибка, при этом результат UnitOfWork.save</p>
</blockquote>

 
        
        <hr>

        

        <div class="well">
  <p>Find an error? <a class="alert-link" href="https://track.rnd.croc.ru/newIssue?project=WC&clearDraft=true&c=Type+Bug&c=State+Open&c=Subsystem+documentation">Let us know →</a></p>
</div>

      </div>
    </div>
  </div>
</div>

    </div>

	<div class="site-footer">
  <p>Built on 31.9.2014 at 21:39. Power by <a href="http://assemble.io">Assemble</a>, <a href="http://gruntjs.com">Grunt</a>, <a href="http://code.rnd.croc.ru/projects/RND/repos/jsdoc2markdown">jsdoc2markdown</a>.
</p></div>

    <script src="../../assets/js/jquery.js"></script>
<script src="../../assets/js/bootstrap.min.js"></script>
<script src="../../assets/js/highlight.js"></script>
  </body>
</html>
