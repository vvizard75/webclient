<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Validation | WebClient documentation</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="../../assets/css/root.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body style="background: white;" data-spy="scroll" data-target=".bs-sidebar">

    <div class="root">
    
<div class="navbar navbar-inverse" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../index.html">WebClient documentation</a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      
        <ul class="nav navbar-nav">
          <li class="active"><a href="index.html">Docs</a></li>
          <li><a href="../api-client/index.html">API Client</a></li>
        </ul>
      

      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">CROC R&D<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="https://track.rnd.croc.ru">Bug tracker (YouTrack)</a></li>
            <li><a href="https://code.croc.ru">Source code (Git Server)</a></li>
            <li><a href="https://wiki.rnd.croc.ru">Wiki</a></li>
            <li><a href="https://build.rnd.croc.ru">Build server (TeamCity)</a></li>
            <li><a href="https://qa.rnd.croc.ru">Q&A</a></li>
            <li class="divider"></li>
            <li class="dropdown-header">Other</li>
            <li><a href="https://github.com/CrocInc">CROC on Github</a></li>
            
          </ul>
        </li>
      </ul>

    </nav>
  </div>
</div>

    
<div class="container" role="main">
  <div class="row">

    
    <div class="col col-lg-3">
      <div class="sidebar">
        <ul class="nav nav-pills nav-stacked">
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
          <li><a href="structure.html">Structure</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
          <li><a href="browser-support.html">Browser support</a></li>
    
  
    
  
    
  
    
          <li><a href="distribution.html">Distribution</a></li>
    
  
    
  
    
  
    
          <li><a href="setup-developer-environment.html">Setup Developer Environment</a></li>
    
  
    
  
    
  
    
          <li><a href="project-structure.html">Project Structure</a></li>
    
  
    
  
    
  
    
  
    
  
    
          <li><a href="key-features.html">Key Features</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</ul>


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  
    
  

  

  

  
    
  

  

  

  
    
  

  

  
    
      <span class="nav-section-title">
        <a href="getting-started-tutorial.html">Getting Started Tutorial</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="getting-started-tutorial-0_12.html">Getting Started Tutorial 0.12</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
      </ul>

    
  

  

  

  
    
  

  

  
    
      <span class="nav-section-title">
        <a href="base.html">Base</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="ecmascript-5-emulation.html">EcmaScript 5 emulation</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="module-system.html">Module System</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="core.html">Core</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="class-system.html">Class System</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="presentation-model.html">Presentation Model</a></li>
        
        
       
        
         

          <li><a href="composition-&amp;-navigation.html">Composition &amp; Navigation</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="переопределение-компонентов.html">Переопределение компонентов</a></li>
        
        
       
        
         

          <li><a href="templating.html">Templating</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="data-binding.html">Data-binding</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="eventpublisher.html">EventPublisher</a></li>
        
        
       
        
       
        
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="application.html">Application</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
         

          <li><a href="app-module.html">App-module</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="datasource.html">DataSource</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="domain-model.html">Domain Model</a></li>
        
        
       
        
         

          <li><a href="domain-objects.html">Domain Objects</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li class="active"><a href="validation.html">Validation</a></li>
        
        
       
        
       
        
         

          <li><a href="formatters.html">Formatters</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="interop.html">Interop</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="main_js.html">main.js</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="ui-ux.html">UI-UX</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
         

          <li><a href="app-starting-ux.html">App starting UX</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="appnavbar.html">AppNavBar</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="css-styles-and-less.html">CSS Styles and LESS</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="tree.html">Tree</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="icons.html">Icons</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="menu.html">Menu</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="objecteditor.html">ObjectEditor</a></li>
        
        
       
        
       
        
         

          <li><a href="objectlist.html">ObjectList</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="objectviewer.html">ObjectViewer</a></li>
        
        
       
        
         

          <li><a href="objectwizard.html">ObjectWizard</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="onlinebeacon.html">OnlineBeacon</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="property-editors.html">Property Editors</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="objectfilter.html">ObjectFilter</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="appservices.html">AppServices</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
         

          <li><a href="affix.html">Affix</a></li>
        
        
       
        
         

          <li><a href="app-navigation.html">App Navigation</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="breadcrumbs.html">Breadcrumbs</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="client-update-notification.html">Client update notification</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="debug-module.html">Debug module</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="drafts.html">Drafts</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="i18n.html">i18n</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="notifications.html">Notifications</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="security.html">Security</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="scroll-accelerators.html">Scroll accelerators</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="reporting.html">Reporting</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="server.html">Server</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="server-architecture.html">Server Architecture</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="page-layout.html">Page Layout</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="filecontroller.html">FileController</a></li>
        
        
       
        
         

          <li><a href="bootloader.html">Bootloader</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="main_config_json.html">main.config.json</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="hosting.html">Hosting</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="knowledge-base.html">Knowledge Base</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="client-debugging.html">Client Debugging</a></li>
        
        
       
        
       
        
       
        
       
        
         

          <li><a href="кеширование-контента.html">Кеширование контента</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="webstorm-live-templates.html">WebStorm Live Templates</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="efficient-css.html">Efficient CSS</a></li>
        
        
       
        
         

          <li><a href="elmah.html">Elmah</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
        
       
      </ul>

    
  

  
    
      <span class="nav-section-title">
        <a href="devtools.html">DevTools</a> 
      </span>

      <ul class="nav nav-pills nav-stacked">
      
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="archived-build-0_10.html">Archived-Build 0.10</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="настройка-teamcity-билд-конфигурации-для-работы-с-bower-и-grunt.html">Настройка TeamCity билд конфигурации для работы с bower и grunt</a></li>
        
        
       
        
       
        
       
        
         

          <li><a href="yeoman-generator.html">Yeoman Generator</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="grunt-croc-qunit.html">grunt-croc-qunit</a></li>
        
        
       
        
         

          <li><a href="grunt-croc-requirejs.html">grunt-croc-requirejs</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
         

          <li><a href="resxtojson.html">ResxToJson</a></li>
        
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
       
        
        
        
       
      </ul>

    
  


      </div>
    </div>


    
    <div class="col col-lg-9">
      <div class="panel panel-docs">
        <ol class='breadcrumb'><li><a href='index.html'>Docs</a></li><li><a href='application.html'>Application</a></li><li class='active'>Validation</li></ol>
        <h1>Validation</h1>
          

<p>Редактирование объектов неразрывно связано с валидацией. Везде, где есть модификация объектов, будет валидация. Основным контекстом использования валидации является редактор.</p>
<h5 id="overview">Overview</h5>
<p>Валидация состоит из следующих элементов:</p>
<ul>
<li>парсеры - функции, связанные с метаописателем свойства типа. Они принимают значение в произвольном формате (но обычно в виде строки) и возвращают либо приведенное значение, либо сообщение об ошибке (в случае некорректного значения). Отличие парсеров от всех остальных механизмов в том, что они вызываются всегда при установке значения и могут сгенерировать ошибку. Если установка значения выполняется байндингом, то она перехватывается и на элементе-источнике генерируется событие <code>bindingErrorChanged</code>. На это событие подписываются все редакторы свойств (в методе <code>PropertyEditor.databind</code>) для того, чтобы при возникновении этого события отобразить ошибочное состояние контрола;</li>
<li>фасеты - фиксированные проверки значений свойств, определяемые декларативно в доменной модели. Фактически, фасет - это компонент, связанный с  метаописателем свойства, имеющий метод validate. Метод принимает значение свойства и может вернуть сообщение об ошибки, либо пустоту (проверка пройдена);</li>
<li>правила валидации для свойств - имеют такой же API как реализации фасетов, но задаются явно. Правила - это объекты с методом validate, которые должны быть добавлены в массивный атрибут <code>rules</code> метаописателя свойства;</li>
<li>правила валидации для редактора свойства - аналогичны правилам валидации для свойства, только задаются в метаданных редактора. По умолчанию все правила валидации для свойства являются правилами валидации для редактора свойства. Если правила для редактора свойства заданы явно, то они объединяются с правилами валидации для свойства;</li>
<li>правила валидации для объектов - функция, определяемая для объекта или его прототипа. Функция может вернуть: <ul>
<li>текст - описание одной ошибки</li>
<li>объект с полем error и опциональным атрибутом <code>props</code>, содержащем массив наименований свойств, к которым относится ошибка;</li>
<li>массив объектов из предыдущего пункта;</li>
</ul>
</li>
<li>правила валидации для редактора - аналогичны правилам валидации для объекта, только определяются для редактора</li>
</ul>
<p>Кто и когда вызывает описанные механизмы валидации:</p>
<ul>
<li>при установке значения свойства вызывается парсер, заданный для его метасвойства. Если возникла ошибка, то редактор свойства получает уведомление (через событие <code>bindingErrorChanged</code>) и устанавливает css-класс ошибочного состояния (x-pe-invalid&quot;). </li>
<li>в редакторе: при наличии правил валидации для редактора свойства (в том числе для самого свойства) он (в <code>PropertyEditor.databind</code>) подписывается на событие изменения значения свойства. В обработчике изменения значения он вызывает все свои правила, если любое их них возвращает ошибку, то редактор свойства устанавливает css-класс ошибочного состояния и признак</li>
<li>в редакторе при сохранении вызывается метод validate (также перед и после метода вызываются методы onValidating и onValidated при их наличии), в котором:<ul>
<li>ищутся редакторы свойств на всех страницах, в которых возникали ошибки байндинга</li>
<li>вызываются все правила валидации для текущего объекта - validation.validateObject</li>
<li>вызываются все правила валидации для редактора (заданные в коллекции rules метаданных редактора) - особенности валидации в редакторе см. в <a href='objecteditor.html' title='null'>ObjectEditor</a></li>
</ul>
</li>
<li>метод модуля: validation.validateObject(obj), включает в себя:<ul>
<li>вызов всех правил валидации для всех свойств объекта (включая фасеты)</li>
<li>вызов всех правил валидации для типа (из коллекции rules метаописания типа) и объекта (метод validate объекта или прототипа) </li>
</ul>
</li>
</ul>
<h5 id="extensibility">Extensibility</h5>
<h6 id="-">Фасет</h6>
<p>Набор фасетов для свойств может быть легко расширен. При инициализации модели реализации фасетов берутся из словаря <code>validation.facets</code>. Наименованиями полей объекта <code>validation.facets</code> являются фасеты. Например:</p>
<pre><code class="lang-js">validation.facets = {
    maxLen: lang.Class({ ... })
}
</code></pre>
<p>При инициализации модели для каждого метасвойства каждого типа ищется атрибут-фасет. Например:</p>
<pre><code class="lang-js">var metadata = {
        entities: {
            Type: {
                props: [
                    title: { vt: &quot;string&quot;, maxLen: 128 },
                    ...
                ]
            }
        }
    };
</code></pre>
<p>При его наличии, для данного свойства создается экземпляр фасета и помещается в коллекцию правил валидации:</p>
<pre><code class="lang-js">for(var facetName in validation.facets) {
        if (propInfo[facetName]) {
            if (!propInfo.rules)
                propInfo.rules = [];
            propInfo.rules.push(new validation.facets[facetName](propInfo));
        }
    }
</code></pre>
<p>В рантайме при выполнении валидации для объекта выполняются все правила для каждого свойства:</p>
<pre><code class="lang-js">if (propMeta.rules) {
        for (i=0; i &lt; propMeta.rules.length; i++) {
            rule = propMeta.rules[i];
            result = rule.validate(propValue);
            if (result)
                return result;
        }
    }
</code></pre>
<p>Если метод validate правила вернул не пустоту, то результат трактуется как сообщение об ошибке.
Таким образом для создания кастомного фасета надо:</p>
<ul>
<li>добавить его в <code>validation.facets</code></li>
</ul>
<pre><code class="lang-js">validation.facets.myfacet = lang.Class({ 
    constructor: function(propMeta) { 
        this.param = propMeta.myfacet;
    },
    validate: function(propValue) { ... }
});
</code></pre>
<ul>
<li>использовать фасет для свойств(а):</li>
</ul>
<pre><code class="lang-js">var metadata = {
        entities: {
            Type: {
                props: [
                    title: { vt: &quot;string&quot;, myfacet: &quot;значение фасета&quot; },
                    ...
                ]
            }
        }
    };
</code></pre>
<h6 id="-">Правила валидации для свойства</h6>
<p>Помимо фасетов для метаописателя свойства могут быть явно заданы правила валидации:</p>
<pre><code class="lang-js">var metadata = {
        entities: {
            Type: {
                props: [
                    title: { vt: &quot;string&quot;, descr:&quot;Заголовок&quot;, rules: [ myValidationRules.onlyValidChars ] },
                    ...
                ]
            }
        }
    };
    var myValidationRules = {
        onlyValidChars: {
            validate: function(propValue) {
                if (/[!@#$%^&amp;*()]$/.test(propValue))
                    return &quot;Заголовок не может содержать символов !@#$%^&amp;*()&quot;;
            }
        }
    };
</code></pre>
<p>Также правила валидации можно задать в качестве методов validateИмясвойства, которые ищутся в экземпляре объекта (т.о. они могут быть заданы либо для объекта, либо для его прототипа):</p>
<pre><code class="lang-js">model.Survey.prototype.validateTitle = function(propValue) {
        if (/[!@#$%^&amp;*()]$/.test(propValue))
            return &quot;Заголовок не может содержать символов !@#$%^&amp;*()&quot;;
    }
</code></pre>
<h6 id="-">Правила валидации для объекта</h6>
<p>Правила валидации для объекта определяются в массивном атрибуте <code>rules</code> метаописателя типа, либо в качестве метода validate экземпляра объекта.
Пример:</p>
<pre><code class="lang-js">var metadata = {
        entities: {
            Type: {
                props: [...]
                rules: [ {
                    validate: function(obj) {
                        return &quot;Ошибка&quot;;
                        // OR:
                        return {error: &quot;Ошибка&quot;, props: [&quot;prop1&quot;, &quot;prop2&quot;]};
                    }
                } ]
            }
        }
    };
</code></pre>
<pre><code class="lang-js">model.Survey.prototype.validate = function() {
    if (this.closed() &amp;&amp; this.created() &amp;&amp; this.closed() &lt; this.created())
        return {error: &quot;Дата закрытия не может быть меньше даты создания&quot;, props: [&quot;created&quot;, &quot;closed&quot;]};
};
</code></pre>
<blockquote>
<p>См. также <a href='objecteditor.html#Правила валидации для редактора' title='null'>Правила валидации для редактора</a></p>
</blockquote>
<h5 id="api">API</h5>
<h6 id="-violation-">Объект ошибки (violation)</h6>
<p>В качестве результата выполнения метода <code>validate</code> правила валидации ожидается:</p>
<ul>
<li>пустота - ошибок нет</li>
<li>строка - описание ошибки</li>
<li>объект - описание ошибки - json-объект следующего API:</li>
</ul>
<pre><code class="lang-js">error {String} - описание ошибки
props {Array} - массив строк, где каждый элемент является наименованием свойства, вызвавшего ошибку
object {Object} - объект, вызвавший ошибку
pageName {String} - наименование страницы редактора, к которой относится ошибка (может быть не задано, тогда редактор попытается найти страницу по редактору свойству, соответствующему свойству из массива props)
severity {&quot;error&quot;|&quot;warning&quot;|&quot;info&quot;} - &quot;важность&quot; ошибки, по умолчанию все ошибки являются блокирующими (&quot;error&quot;), но правило валидации может установить severity равное &quot;warning&quot; или &quot;info&quot;, тогда наличие подобной ошибки не будет  препятствовать сохранению
description {String} - подробное описание ошибки
</code></pre>
<blockquote>
<p>Дополнительно объект ошибки может содержать какие угодно атрибуты, все они будут доступны в прикладных обработчиках.</p>
</blockquote>
<p>Варианты заполнения объекта-ошибки:</p>
<ul>
<li>задан только текст:</li>
</ul>
<pre><code class="lang-js">{
  error: &quot;Ошибка&quot;
}
</code></pre>
<ul>
<li>задан текст и страница:</li>
</ul>
<pre><code class="lang-js">{
  error: &quot;Ошибка&quot;,
  pageName: &quot;main&quot;
}
</code></pre>
<ul>
<li>задан текст и свойства объекта</li>
</ul>
<pre><code class="lang-js">{
  error: &quot;Ошибка&quot;,
  object: viewModel
  props: [&quot;title&quot;]
}
</code></pre>
<ul>
<li>задан текст, свойства объекта и страница</li>
</ul>
<pre><code class="lang-js">{
  error: &quot;Ошибка&quot;,
  object: viewModel
  props: [&quot;title&quot;],
  pageName: &quot;main&quot;
}
</code></pre>

 
        
        <hr>

        

        <div class="well">
  <p>Find an error? <a class="alert-link" href="https://track.rnd.croc.ru/newIssue?project=WC&clearDraft=true&c=Type+Bug&c=State+Open&c=Subsystem+documentation">Let us know →</a></p>
</div>

      </div>
    </div>
  </div>
</div>

    </div>

	<div class="site-footer">
  <p>Built on 31.9.2014 at 21:39. Power by <a href="http://assemble.io">Assemble</a>, <a href="http://gruntjs.com">Grunt</a>, <a href="http://code.rnd.croc.ru/projects/RND/repos/jsdoc2markdown">jsdoc2markdown</a>.
</p></div>

    <script src="../../assets/js/jquery.js"></script>
<script src="../../assets/js/bootstrap.min.js"></script>
<script src="../../assets/js/highlight.js"></script>
  </body>
</html>
